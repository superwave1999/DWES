{"filter":false,"title":"doedit.php","tooltip":"/user/doedit.php","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":52,"column":28},"action":"insert","lines":["<?php","","use izv\\data\\Usuario;","use izv\\database\\Database;","use izv\\managedata\\ManageUsuario;","use izv\\tools\\Reader;","use izv\\tools\\Util;","use izv\\tools\\Session;","use izv\\app\\App;","","require '../classes/autoload.php';","","//Protection","$sesion = new Session(App::SESSION_NAME);","$adminuser = $sesion->getLogin()->getAdministrador();","","if(!$sesion->isLogged() || $adminuser!=1) {","    header('Location: ..');","    exit();","}","","","","","","","","","","$db = new Database();","$manager = new ManageUsuario($db);","$usuario = Reader::readObject('izv\\data\\Usuario');","","var_export($usuario);","","","","$usuario->setAdministrador(Util::checkboxToMySQL($usuario->getAdministrador()));","$usuario->setActivo(Util::checkboxToMySQL($usuario->getActivo()));","","","if($usuario->getClave()==='') {","    $resultado = $manager->edit($usuario);","} else {","    ","    $usuario->setClave(Util::encriptar($usuario->getClave()));","    $resultado = $manager->editWithPassword($usuario);","}","","$db->close();","","$url = Util::url() . 'index.php?op=edit&resultado=' . $resultado;","header('Location: ' . $url);"],"id":1}],[{"start":{"row":16,"column":23},"end":{"row":16,"column":40},"action":"remove","lines":[" || $adminuser!=1"],"id":2}]]},"ace":{"folds":[],"scrolltop":180,"scrollleft":0,"selection":{"start":{"row":16,"column":23},"end":{"row":16,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":9,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1543862918459,"hash":"9dd05b79636a46b398bd419f17d17a093d60cee5"}